'use client';

import { useState, useEffect, useRef } from 'react';
import { createClient } from '@/lib/supabase/client';
import { toast } from 'sonner';
import { Loader2, Upload, CheckCircle, AlertCircle, ArrowLeft, ArrowRight, ShoppingBag, Package, Users } from 'lucide-react';
import { compressImage } from '@/lib/utils';
import { 
    MERCH_ITEMS, 
    MERCH_BUNDLES, 
    UPI_CONFIG, 
    calculateBundlePrice,
    MerchItemType,
    MerchBundleType,
    BundleItem
} from '@/types/payment';
import QRCode from 'react-qr-code';

interface FormData {
    name: string;
    email: string;
    phone_number: string;
    bundle_type: MerchBundleType;
    bundle_items: BundleItem[];
}

export default function MerchForm() {
    const supabase = createClient();
    const [loading, setLoading] = useState(false);
    const [step, setStep] = useState<1 | 2 | 3>(1);
    const [formData, setFormData] = useState<FormData>({
        name: '',
        email: '',
        phone_number: '',
        bundle_type: 'solo',
        bundle_items: [],
    });

    // Payment states
    const [paymentProof, setPaymentProof] = useState<File | null>(null);
    const [paymentUtr, setPaymentUtr] = useState('');
    const paymentFileRef = useRef<HTMLInputElement>(null);

    const sizes = ['XS', 'S', 'M', 'L', 'XL', 'XXL'];

    // Fetch user profile data and pre-fill form
    useEffect(() => {
        const fetchUserData = async () => {
            const { data: { user } } = await supabase.auth.getUser();
            if (!user) return;

            const { data: profile } = await supabase
                .from('profiles')
                .select('full_name, email, phone')
                .eq('id', user.id)
                .single();

            if (profile) {
                setFormData(prev => ({
                    ...prev,
                    name: profile.full_name || '',
                    email: profile.email || '',
                    phone_number: profile.phone || '',
                }));
            }
        };

        fetchUserData();
    }, [supabase]);

    // Initialize bundle items when bundle_type changes
    useEffect(() => {
        // Generate empty bundle items based on bundle count
        const itemCount = MERCH_BUNDLES[formData.bundle_type].itemCount;
        const newBundleItems: BundleItem[] = Array.from({ length: itemCount }, (_, i) => ({
            item: '',
            size: '',
            index: i,
        }));

        setFormData(prev => ({
            ...prev,
            bundle_items: newBundleItems,
        }));
    }, [formData.bundle_type]);

    // Calculate total amount
    const getTotalAmount = () => {
        return calculateBundlePrice(formData.bundle_items, formData.bundle_type);
    };

    // Update item for a specific bundle position
    const updateBundleItemType = (index: number, itemType: MerchItemType) => {
        setFormData(prev => ({
            ...prev,
            bundle_items: prev.bundle_items.map((item, i) => 
                i === index ? { ...item, item: itemType } : item
            ),
        }));
    };

    // Update size for a specific bundle item
    const updateBundleItemSize = (index: number, size: string) => {
        setFormData(prev => ({
            ...prev,
            bundle_items: prev.bundle_items.map((item, i) => 
                i === index ? { ...item, size } : item
            ),
        }));
    };

    // Check if all items and sizes are selected
    const allItemsSelected = () => {
        return formData.bundle_items.length > 0 && 
               formData.bundle_items.every(item => item.item !== '' && item.size !== '');
    };

    // Payment proof file handler
    const handlePaymentProofChange = (e: React.ChangeEvent<HTMLInputElement>) => {
        if (e.target.files && e.target.files[0]) {
            setPaymentProof(e.target.files[0]);
        }
    };

    // Upload file to Supabase Storage
    const uploadFile = async (file: File): Promise<string> => {
        const compressedFile = await compressImage(file);
        const sanitizedEmail = formData.email.replace(/[^a-zA-Z0-9]/g, '_');
        const fileName = `${sanitizedEmail}/merch_${Date.now()}.jpg`;

        const { data, error } = await supabase.storage
            .from('payment-proofs')
            .upload(fileName, compressedFile);

        if (error) {
            throw new Error('Failed to upload file: ' + error.message);
        }
return true;
    };

    // Handle proceeding to item selection
    const handleProceedToItems = () => {
        if (validateStep1()) {
            setStep(2);
        }
    };

    // Handle proceeding to payment step
    const handleProceedToPayment = () => {
        if (!allItemsSelected()) {
            toast.error('Please select an item and size for each member
    const handleProceedToSizes = () => {
        if (validateStep1()) {
            setStep(2);
        }
    };

    // Handle proceeding to payment step
    const handleProceedToPayment = () => {
        if (!allSizesSelected()) {
            toast.error('Please select a size for each item');
            return;
        }
        setStep(3);
    };

    // Handle final submission
    const handleSubmit = async (e: React.FormEvent) => {
        e.preventDefault();

        if (!paymentUtr && !paymentProof) {
            toast.error('Please provide EITHER a Transaction UTR OR a Payment Screenshot to verify.');
            return;
        }

        setLoading(true);

        try {
            const { data: { user } } = await supabase.auth.getUser();
            if (!user) {
                toast.error('You must be logged in to order');
                setLoading(false);
                return;
            }

            // Upload payment proof if exists
            let paymentScreenshotPath = null;
            if (paymentProof) {
                toast.loading('Uploading payment proof...', { id: 'upload-payment' });
                paymentScreenshotPath = await uploadFile(paymentProof);
                toast.dismiss('upload-payment');
            }

            // Insert into database
            toast.loading('Submitting order...', { id: 'submit' });
            const { error: insertError } = await supabase
                .from('merch_orders')
                .insert([
                    {
                        user_id: user.id,
                        name: formData.name,
                        email: formData.email,
                        phone_number: formData.phone_number,
                        bundle_type: formData.bundle_type,
                        item_type: formData.item_type,
                        bundle_items: formData.bundle_items,
                        total_items: formData.bundle_items.length,
                        amount: getTotalAmount(),
                        payment_status: 'penbundle_items.length > 0 ? formData.bundle_items[0].item : 'tshirt1'fication',
                        payment_utr: paymentUtr || null,
                        payment_screenshot_path: paymentScreenshotPath,
                    },
                ]);

            toast.dismiss('submit');

            if (insertError) {
                toast.error('Order failed: ' + insertError.message);
                setLoading(false);
                return;
            }

            toast.success('ðŸŽ‰ Order submitted! Your payment will be verified shortly.', {
                duration: 5000,
            });

            // Reload the page to show submitted status
            setTimeout(() => {
                window.location.reload();
            }, 1500);

        } catch (error: unknown) {
            console.error('Form submission error:', error);
            const errorMessage = error instanceof Error ? error.message : 'An error occurred. Please try again.';
            toast.error(errorMessage);
        } finally {
            setLoading(false);
        }
    };

    const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>) => {
        setFormData({
            ...formData,
            [e.target.name]: e.target.value,
        });
    };

    // Generate UPI payment string
    const getUPIString = () => {
        const amount = getTotalAmount();
        return `upi://pay?pa=${UPI_CONFIG.VPA}&pn=${encodeURIComponent(UPI_CONFIG.NAME)}&am=${amount}&tn=ESummit26_Merch`;
    };

    // Get step title
    const getStepTitle = () => {
        switch (step) {
            case 1:
                return 'Step 1: Select your merchandise and bundle';
            case 2:
                return 'Step 2: Select sizes for each item';
            case 3:
                return `Step 3: Contact details and bundle type';
            case 2:
                return `Step 2: Select items for ${MERCH_BUNDLES[formData.bundle_type].itemCount} member(s)`

    return (
        <div className="w-full max-w-2xl mx-auto p-6 bg-[#0a0a0a]/90 backdrop-blur-sm border border-white/10 rounded-2xl">
            <div className="mb-6">
                <h2 className="text-3xl font-heading font-bold text-white mb-2">
                    E-Summit Merchandise
                </h2>
                <p className="text-white/60 text-sm">{getStepTitle()}</p>

                {/* Step indicator */}
                <div className="flex items-center gap-2 mt-4">
                    {[1, 2, 3].map((s) => (
                        <div key={s} className="flex items-center">
                            <div className={`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold transition-all ${
                                step > s ? 'bg-green-500 text-white' :
                                step === s ? 'bg-[#a855f7] text-white' : 
                                'bg-white/20 text-white/40'
                            }`}>
                                {step > s ? 'âœ“' : s}
                            </div>
                            {s < 3 && (
                                <div className="h-1 w-8 mx-1 bg-white/20 rounded overflow-hidden">
                                    <div className={`h-full rounded transition-all ${step > s ? 'bg-green-500 w-full' : 'w-0'}`} />
                                </div>
                            )}
                        </div>
                    ))}
                </div>
            </div>

            {step === 1 && (
                /* Step 1: Contact Details and Bundle Selection */
                <form onSubmit={(e) => { e.preventDefault(); handleProceedToItems(); }} className="space-y-5">
                    {/* Contact Details */}
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label className="block text-sm font-medium text-white/80 mb-2">Name</label>
                            <input
                                type="text"
                                name="name"
                                value={formData.name}
                                onChange={handleChange}
                                required
                                className="w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder:text-white/30 focus:outline-none focus:border-[#a855f7]/50 transition-all"
                                placeholder="Your name"
                            />
                        </div>
                        <div>
                            <label className="block text-sm font-medium text-white/80 mb-2">Phone</label>
                            <input
                                type="tel"
                                name="phone_number"
                                value={formData.phone_number}
                                onChange={handleChange}
                                required
                                className="w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder:text-white/30 focus:outline-none focus:border-[#a855f7]/50 transition-all"
                                placeholder="+91 98765 43210"
                            />
                        </div>
                    </div>

                    {/* Bundle Type Selection */}
                    <div>
                        <label className="block text-sm font-medium text-white/80 mb-3">
                            Select Bundle Type <span className="text-red-400">*</span>
                        </label>
                        <p className="text-white/50 text-xs mb-3">How many members are purchasing?</p>
                        <div className="grid grid-cols-1 sm:grid-cols-3 gap-3">
                            {(Object.entries(MERCH_BUNDLES) as [MerchBundleType, typeof MERCH_BUNDLES[MerchBundleType]][]).map(([key, bundle]) => (
                                <button
                                    key={key}
                                    type="button"
                                    onClick={() => setFormData({ ...formData, bundle_type: key })}
                                    className={`p-5 rounded-xl border text-center transition-all ${
                                        formData.bundle_type === key
                                            ? 'border-[#a855f7] bg-[#a855f7]/10 ring-2 ring-[#a855f7]/30'
                                            : 'border-white/10 hover:border-white/30'
                                    }`}
                                >
                                    <div className="flex flex-col items-center gap-2">
                                        {key === 'solo' && <Package className={`w-8 h-8 ${formData.bundle_type === key ? 'text-[#a855f7]' : 'text-white/40'}`} />}
                                        {key === 'duo' && <Users className={`w-8 h-8 ${formData.bundle_type === key ? 'text-[#a855f7]' : 'text-white/40'}`} />}
                                        {key === 'quad' && (
                                            <div className="flex gap-0.5">
                                                <Users className={`w-6 h-6 ${formData.bundle_type === key ? 'text-[#a855f7]' : 'text-white/40'}`} />
                                                <Users className={`w-6 h-6 ${formData.bundle_type === key ? 'text-[#a855f7]' : 'text-white/40'}`} />
                                            </div>
                                        )}
                                        <p className="text-white font-bold">{bundle.label}</p>
                                        <p className="text-white/50 text-xs">{bundle.description}</p>
                                        {bundle.discount > 0 && (
                                            <span className="text-green-400 text-xs font-mono mt-1">
                                                Save {Math.round(bundle.discount * 100)}%
                                            </span>
                                        )}
                                    </div>
                                </button>
                            ))}
                        </div>
                    </div>

                    {/* Info Box */}
                    <div className="p-4 bg-blue-500/10 border border-blue-500/20 rounded-xl">
                        <div className="flex items-start gap-3">
                            <AlertCircle className="w-5 h-5 text-blue-400 flex-shrink-0 mt-0.5" />
                            <div className="text-blue-300 text-sm">
                                <p className="font-bold mb-1">Bundle Benefits:</p>
                                <ul className="list-disc list-inside space-y-1 text-xs">
                                    <li>Each member can choose their preferred item & size</li>
                                    <li>Duo bundle: Select 2 products (10% discount)</li>
                                    <li>Quad bundle: Select 4 products (15% discount)</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    {/* Proceed Button */}
                    <button
                        type="submit"
                        className="w-full py-4 px-6 bg-[#a855f7] hover:bg-[#9333ea] text-white font-bold rounded-xl transition-all duration-300 flex items-center justify-center gap-3"
                    >
                        <span>Select Items</span>
                        <ArrowRight className="w-5 h-5" />
                    </button>
                </form>
            )}

            {step === 2 && (
                /* Step 2: Item and Size Selection for Each Member */
                <div className="space-y-5">
                    <button
                        onClick={() => setStep(1)}
                        className="flex items-center gap-2 text-white/50 hover:text-white transition-colors text-sm"
                    >
                        <ArrowLeft className="w-4 h-4" />
                        Back to Bundle Selection
                    </button>

                    <div className="p-4 bg-white/5 border border-white/10 rounded-xl">
                        <h4 className="text-white font-bold mb-2">Select Item & Size for Each Member</h4>
                        <p className="text-white/50 text-sm">
                            Configure {formData.bundle_items.length} product(s) - each member can choose their preferred item and size.
                        </p>
                    </div>

                    <div className="space-y-6">
                        {formData.bundle_items.map((bundleItem, index) => (
                            <div key={index} className="p-5 bg-white/5 border border-white/10 rounded-xl space-y-4">
                                {/* Member Header */}
                                <div className="flex items-center gap-3 pb-3 border-b border-white/10">
                                    <div className="w-10 h-10 rounded-full bg-[#a855f7]/20 flex items-center justify-center text-[#a855f7] font-bold">
                                        {index + 1}
                                    </div>
                                    <div>
                                        <p className="text-white font-bold">Member {index + 1}</p>
                                        <p className="text-white/50 text-xs">
                                            {bundleItem.item && bundleItem.size 
                                                ? `${MERCH_ITEMS[bundleItem.item].label} - Size ${bundleItem.size}` 
                                                : 'Not configured'}
                                        </p>
                                    </div>
                                </div>

                                {/* Item Selection */}
                                <div>
                                    <label className="block text-sm font-medium text-white/80 mb-2">
                                        Select Item <span className="text-red-400">*</span>
                                    </label>
                                    <div className="grid grid-cols-1 gap-2">
                                        {(Object.entries(MERCH_ITEMS) as [MerchItemType, typeof MERCH_ITEMS[MerchItemType]][]).map(([key, item]) => (
                                            <button
                                                key={key}
                                                type="button"
                                                onClick={() => updateBundleItemType(index, key)}
                                                className={`p-3 rounded-lg border text-left transition-all ${
                                                    bundleItem.item === key
                                                        ? 'border-[#a855f7] bg-[#a855f7]/10'
                                                        : 'border-white/10 hover:border-white/30'
                                                }`}
                                            >
                                                <div className="flex items-center gap-3">
                                                    <div className={`w-4 h-4 rounded-full border-2 flex items-center justify-center ${
                                                        bundleItem.item === key 
                                                            ? 'border-[#a855f7] bg-[#a855f7]' 
                                                            : 'border-white/40'
                                                    }`}>
                                                        {bundleItem.item === key && (
                                                            <div className="w-1.5 h-1.5 rounded-full bg-white" />
                                                        )}
                                                    </div>
                                                    <ShoppingBag className={`w-6 h-6 ${bundleItem.item === key ? 'text-[#a855f7]' : 'text-white/40'}`} />
                                                    <div className="flex-1">
                                                        <p className="text-white font-semibold text-sm">{item.label}</p>
                                                        <p className="text-white/50 text-xs">{item.description}</p>
                                                    </div>
                                                    <p className="text-[#a855f7] font-heading">â‚¹{item.price}</p>
                                                </div>
                                            </button>
                                        ))}
                                    </div>
                                </div>

                                {/* Size Selection */}
                                {bundleItem.item && (
                                    <div>
                                        <label className="block text-sm font-medium text-white/80 mb-2">
                                            Select Size <span className="text-red-400">*</span>
                                        </label>
                                        <div className="flex flex-wrap gap-2">
                                            {sizes.map((size) => (
                                                <button
                                                    key={size}
                                                    type="button"
                                                    onClick={() => updateBundleItemSize(index, size)}
                                                    className={`px-4 py-2 rounded-lg border font-mono text-sm transition-all ${
                                                        bundleItem.size === size
                                                            ? 'border-[#a855f7] bg-[#a855f7] text-white'
                                                            : 'border-white/20 text-white/60 hover:border-white/40'
                                                    }`}
                                                >
                                                    {size}
                                                </button>
                                            ))}
                                        </div>
                                    </div>
                                )}

                                {/* Completion Status */}
                                {bundleItem.item && bundleItem.size && (
                                    <div className="flex items-center gap-2 pt-2 border-t border-white/10">
                                        <CheckCircle className="w-4 h-4 text-green-400" />
                                        <p className="text-green-400 text-sm">
                                            Member {index + 1} configured: {MERCH_ITEMS[bundleItem.item].label} (Size {bundleItem.size})
                                        </p>
                                    </div>
                                )}
                            </div>
                        ))}
                    </div>

                    {/* Progress indicator */}
                    <div className="p-4 bg-white/5 border border-white/10 rounded-xl">
                        <div className="flex justify-between items-center mb-2">
                            <span className="text-white/70 text-sm">Members configured</span>
                            <span className="text-white font-mono">
                                {formData.bundle_items.filter(i => i.item && i.size).length} / {formData.bundle_items.length}
                            </span>
                        </div>
                        <div className="h-2 bg-white/10 rounded-full overflow-hidden">
                            <div 
                                className="h-full bg-[#a855f7] rounded-full transition-all"
                                style={{ width: `${(formData.bundle_items.filter(i => i.item && i.size).length / formData.bundle_items.length) * 100}%` }}
                            />
                        </div>
                    </div>

                    {/* Price Preview */}
                    {getTotalAmount() > 0 && (
                        <div className="p-4 bg-[#a855f7]/10 border border-[#a855f7]/30 rounded-xl">
                            <div className="space-y-2">
                                <div className="flex justify-between items-center text-sm text-white/70">
                                    <span>Bundle: {MERCH_BUNDLES[formData.bundle_type].label}</span>
                                    <span>{formData.bundle_items.length} items</span>
                                </div>
                                {MERCH_BUNDLES[formData.bundle_type].discount > 0 && (
                                    <div className="flex justify-between items-center text-sm text-green-400">
                                        <span>Bundle Discount</span>
                                        <span>-{Math.round(MERCH_BUNDLES[formData.bundle_type].discount * 100)}%</span>
                                    </div>
                                )}
                                <div className="border-t border-white/10 pt-2 flex justify-between items-center">
                                    <span className="text-white font-bold">Total Amount</span>
                                    <span className="text-[#a855f7] font-heading text-2xl">â‚¹{getTotalAmount()}</span>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Proceed Button */}
                    <button
                        onClick={handleProceedToPayment}
                        disabled={!allItemsSelected()}
                        className="w-full py-4 px-6 bg-[#a855f7] hover:bg-[#9333ea] disabled:opacity-50 disabled:cursor-not-allowed text-white font-bold rounded-xl transition-all duration-300 flex items-center justify-center gap-3"
                    >
                        <span>Proceed to Payment</span>
                        <ArrowRight className="w-5 h-5" />
                    </button>
                </div>
            )}

            {step === 3 && (
                /* Step 3: Payment */
                <div className="space-y-6">
                    <button
                        onClick={() => setStep(2)}
                        className="flex items-center gap-2 text-white/50 hover:text-white transition-colors text-sm"
                    >
                        <ArrowLeft className="w-4 h-4" />
                        Back to Sizes
                    </button>

                    {/* Order Summary */}
                    <div className="p-4 bg-white/5 border border-white/10 rounded-xl">
                        <h4 className="text-white font-bold mb-3">Order Summary</h4>
                        <div className="space-y-2 text-sm">
                            <p className="text-white/70">
                                Bundle: <span className="text-white">{MERCH_BUNDLES[formData.bundle_type].label} ({formData.bundle_items.length} items)</span>
                            </p>
                            <div className="border-t border-white/10 pt-2 mt-2">
                                <p className="text-white/70 mb-2">Items:</p>
                                <div className="space-y-1 pl-3">
                                    {formData.bundle_items.map((item, i) => (
                                        <p key={i} className="text-white/60 text-xs">
                                            {i + 1}. {item.item && MERCH_ITEMS[item.item].label} - Size {item.size} - â‚¹{item.item && MERCH_ITEMS[item.item].price}
                                        </p>
                                    ))}
                                </div>
                            </div>
                            {MERCH_BUNDLES[formData.bundle_type].discount > 0 && (
                                <p className="text-green-400 text-xs pt-2">
                                    Bundle discount: {Math.round(MERCH_BUNDLES[formData.bundle_type].discount * 100)}% applied
                                </p>
                            )}
                            <p className="text-white/70 pt-2 border-t border-white/10">
                                Total: <span className="text-[#a855f7] font-bold text-lg">â‚¹{getTotalAmount()}</span>
                            </p>
                        </div>
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                        {/* QR Code Column */}
                        <div className="flex flex-col items-center p-6 rounded-2xl bg-white">
                            <h3 className="text-black font-heading text-xl mb-4 text-center">
                                Scan to Pay â‚¹{getTotalAmount()}
                            </h3>
                            <div className="p-2 border-2 border-black rounded-lg mb-4 bg-white">
                                <QRCode value={getUPIString()} size={200} />
                            </div>
                            <p className="font-mono text-xs text-black/60 text-center break-all max-w-[200px]">
                                {UPI_CONFIG.VPA}
                            </p>
                        </div>

                        {/* Upload Column */}
                        <div>
                            <h3 className="font-heading text-2xl text-white mb-2">Confirm Payment</h3>
                            <p className="font-body text-white/50 text-sm mb-6">
                                1. Transfer â‚¹{getTotalAmount()}.<br />
                                2. Enter UTR/Reference ID.<br />
                                3. Upload screenshot.
                            </p>

                            {/* UTR Input */}
                            <div className="mb-4">
                                <label className="block font-mono text-xs text-white/40 mb-2">UTR / REFERENCE NO.</label>
                                <input
                                    type="text"
                                    value={paymentUtr}
                                    onChange={(e) => setPaymentUtr(e.target.value)}
                                    placeholder="e.g. 432189012345"
                                    className="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white font-mono focus:outline-none focus:border-[#a855f7]"
                                />
                            </div>

                            <div className="flex items-center gap-4 mb-4">
                                <div className="h-px bg-white/10 flex-1"></div>
                                <span className="text-white/40 text-xs font-mono">OR</span>
                                <div className="h-px bg-white/10 flex-1"></div>
                            </div>

                            {/* File Input */}
                            <input
                                type="file"
                                accept="image/*"
                                ref={paymentFileRef}
                                onChange={handlePaymentProofChange}
                                className="hidden"
                            />
                            <div
                                onClick={() => paymentFileRef.current?.click()}
                                className={`border-2 border-dashed rounded-xl p-6 flex flex-col items-center justify-center cursor-pointer transition-colors mb-6 ${
                                    paymentProof
                                        ? 'border-[#a855f7] bg-[#a855f7]/5'
                                        : 'border-white/20 hover:border-white/40 hover:bg-white/5'
                                }`}
                            >
                                {paymentProof ? (
                                    <div className="text-center">
                                        <CheckCircle className="w-8 h-8 text-[#a855f7] mx-auto mb-2" />
                                        <p className="font-body text-white text-sm truncate max-w-[200px]">{paymentProof.name}</p>
                                    </div>
                                ) : (
                                    <div className="text-center">
                                        <Upload className="w-8 h-8 text-white/40 mx-auto mb-2" />
                                        <p className="font-body text-white/70 text-sm">Upload Screenshot</p>
                                    </div>
                                )}
                            </div>

                            <button
                                onClick={handleSubmit}
                                disabled={(!paymentProof && !paymentUtr) || loading}
                                className="w-full py-4 rounded-xl bg-[#a855f7] text-white font-heading text-lg font-bold hover:bg-[#9333ea] disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
                            >
                                {loading ? (
                                    <span className="flex items-center justify-center gap-2">
                                        <Loader2 className="w-5 h-5 animate-spin" />
                                        Submitting...
                                    </span>
                                ) : (
                                    'Submit Order'
                                )}
                            </button>
                        </div>
                    </div>

                    {/* Info Note */}
                    <div className="flex items-start gap-3 p-4 bg-blue-500/10 border border-blue-500/20 rounded-xl">
                        <AlertCircle className="w-5 h-5 text-blue-400 flex-shrink-0 mt-0.5" />
                        <p className="text-blue-300 text-sm">
                            Payment will be verified within 24 hours. Merchandise will be available for collection at the event venue.
                        </p>
                    </div>
                </div>
            )}
        </div>
    );
}
